<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <title>Редактор</title>
    <meta charset="UTF-8"/>
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
    <link href="lib/bootsrap/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="lib/bootsrap/css/checkbox-radio-switch.css" rel="stylesheet"/>
    <link href="lib/bootsrap/css/colorpicker.css" rel="stylesheet"/>
    <link href="css/common.css" rel="stylesheet"/>
    <link href="controls/css/style.css" rel="stylesheet"/>
    <link href="css/editor.css" rel="stylesheet"/>
</head>
<body ng-app="procoApp">
    <div id="id-editor_view" class="scr" style="display:none;">
        <div class="top">
            <div class="top_toolbar">
                <div class="toolbar_left">
                    <a class="logo ml24" href="index.html"></a>
                    <div class="delimeter"></div>
                    <div class="top_proj_name"><input class="top_proj_input js-proj_name" placeholder="Введите имя проекта"/></div>
                </div>
                <div class="toolbar_btns">
                    <span class="tico">
                        <i class="tico_img i_eye" style="position:relative;">
                            <div class="file_input_wr">
                                <input id="id-app_preview_img" class="file_input" type="file" accept="image/jpg"/>
                            </div>
                            <img src="i/add-slide-big.png"/>
                        </i>
                    </span>
                    <div class="delimeter"></div>
                    <span class="tico" onclick="saveTemplate();"><i class="tico_img i_eye"><img src="i/save.png"/></i>Сохранить</span>
                    <div class="delimeter"></div>
                    <span class="tico" onclick="onPreviewClick();"><i class="tico_img"><img src="i/i_eye.png"/></i>Просмотр</span>
                    <span class="pbtn __green __small ml24" onclick="onPublishClick();"><i class="tico_img"><img src="i/publish.png"/></i>Опубликовать</span>
                </div>
            </div>
            <div id="id-user_toolbar" class="toolbar_user">
                <div style="display:none" class="user_avatar js-profile_picture"></div>
                <span style="display:none" class="pbtn __green __small mt4 js-show_login">Войти</span>
                <div style="display:none" class="dropdown_btn js-user_ctx_menu">
                    <div id="id-user_ctx_menu" style="display:none" class="ctx_menu_wr">
                        <div class="ctx_menu_item" onclick="onMyTemplatesClick();">
                            Мои проекты
                        </div>
                        <div class="ctx_menu_item">
                            Настройки профиля
                        </div>
                        <div class="ctx_menu_item js-logout">
                            Выйти
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="id-slides_cnt" class="screen_controls_cnt">
            <!-- Сюда добавляются контролы Slide для переключения экранов -->
            <!-- Используется шаблон для оформления групп, если нужно -->
        </div>
        <div class="workspace_cnt">
            <div id="id-workspace" class="workspace">
                <div id="id-product_cnt" class="product_cnt">
                    <div id="id-control_cnt" class="quick_controls_cnt">
                        <!-- Здесь располагаются "быстрые" контролы, которые показываются поверх продукта при клике или наведении куда-то -->
                    </div>
                    <!--<div id="id-product_screens_cnt">-->
                        <!--&lt;!&ndash; Сюда добавляем программно view различных экранов промо приложения &ndash;&gt;-->
                    <!--</div>-->
                    <!-- Эксперимент с iframe чтобы изолировать стили промо проекта -->
                    <iframe id="id-product_screens_cnt" src="product_cnt.html" style="position: absolute; top: 20px; width: 100%;padding: 0;margin: 0;border: 0;height: 100%;">
                        <!-- Сюда добавляем программно view различных экранов промо приложения -->
                    </iframe>
                </div>
            </div>
            <div class="settings_panel js-setting_panel">
                <!-- Просто пустая левая панель -->
            </div>
            <div id="id-static_controls_cnt" class="settings_panel __right js-setting_panel">
                <!-- Сюда попадают контролы которые показываются постоянно -->
            </div>
        </div>
    </div>
    <div id="id-preview_view" style="display:none">
        <!--<div style="position:relative;margin: 5px">-->
            <!--<div id="id-product_iframe_cnt" class="proto_wr">-->
                <!--&lt;!&ndash; Сюда добавляем программно айфрейм с прототипом для редактирования &ndash;&gt;-->
            <!--</div>-->
        <!--</div>-->
        <div class="scr_wr">
            <div class="top">
                <div class="top_toolbar">
                    <div class="toolbar_left">
                        <a class="logo ml24" href="index.html"></a>
                    </div>
                    <div class="toolbar_btns">
                        <a class="pbtn __small" onclick="onBackToEditorClick();">Назад</a>
                        <span class="pbtn __green __small ml24" onclick="onPublishClick();"><i class="tico_img"><img src="i/publish.png"/></i>Опубликовать</span>
                    </div>
                </div>
                <div id="id-user_toolbar" class="toolbar_user">
                    <!--<div style="display:none" class="user_avatar js-profile_picture"></div>-->
                    <!--<span style="display:none" class="pbtn __green __small mt4 js-show_login">Войти</span>-->
                    <!--<div style="display:none" class="dropdown_btn js-user_ctx_menu">-->
                    <!--<div id="id-user_ctx_menu" style="display:none" class="ctx_menu_wr">-->
                    <!--<div class="ctx_menu_item" onclick="onMyTemplatesClick();">-->
                    <!--Мои проекты-->
                    <!--</div>-->
                    <!--<div class="ctx_menu_item">-->
                    <!--Настройки профиля-->
                    <!--</div>-->
                    <!--<div class="ctx_menu_item js-logout">-->
                    <!--Выйти-->
                    <!--</div>-->
                    <!--</div>-->
                    <!--</div>-->
                    <a class="pbtn __green js-create_new" style="display:none;">Хочу такой же!</a>
                </div>
            </div>
            <div class="published_proj_back">
                <div id="id-product_iframe_cnt" class="proto_wr">
                    <!-- Сюда добавляем программно айфрейм с прототипом для редактирования -->
                </div>
                <div class="social_btns_cnt">
                    <!-- TODO -->
                </div>
            </div>
        </div>
    </div>
    <div id="id-dialogs_view" class="scr_dialog" style="display: none;">
        <!-- для показа диалогов поверх остальных вью -->
    </div>

    <div id="id-modal_cnt" class="scr">
        <!-- parent for modals -->
    </div>

    <!-- Шаблон для группы Slide соответствующих группе экранов -->
    <script id="id-slide_group_template" type="text/template">
        <div class="slide_group">
            <div class="slide_group_label js-slide_group_name">
                <!---->
            </div>
            <div class="js-slides_cnt">
                <!-- Сюда вставляем контролы Slide -->
            </div>
            <div class="js-slide_group_controls">
                <!-- Какие то контролы для группы экранов, например добавление нового -->
            </div>
        </div>
    </script>

    <script id="id-static_control_cnt_template" type="text/template">
        <div>
            <p class="control_label js-label"></p>
            <div class="control_cnt js-control_cnt">

            </div>
        </div>
    </script>

    <!-- Шаблон для рамки выделения вокруг элемента -->
    <script id="id-elem_selection_template" type="text/template">
        <div class="js-selection selection_border">
            <div class="selection_border_bullit __1"></div>
            <div class="selection_border_bullit __2"></div>
            <div class="selection_border_bullit __3"></div>
            <div class="selection_border_bullit __4"></div>
        </div>
    </script>

    <!-- Шаблон для группы Slide соответствующх группе экранов -->
    <script id="id-select_dialog_template" type="text/template">
        <div class="modal_wr">
            <div class="select_dialog_back">
                <div class="select_dialog_caption">
                    <span class="js-caption">Выбрать</span>
                </div>
                <div class="loading_anim_wr js-loader" style="display:none;margin-top:50px;">
                    <div class="loading_anim"></div>
                </div>
                <div class="select_dialog_options_cnt js-options_cnt">
                    <!-- Сюда будут программно добавлять опции -->
                </div>
                <div class="select_dialog_button_cnt">
                    <a class="pbtn js-cancel">Отмена</a>
                    <a class="pbtn __green js-confirm">Добавить</a>
                </div>
            </div>
        </div>
    </script>

    <!-- шаблон элемента который вставляются в диалг выбора -->
    <script id="id-select_dialog_option_template" type="text/template">
        <div class="select_dialog_option js-option">
            <div class="select_dialog_option_thumb_cnt js-option_icon">
                <!-- Этому элементу надо указать backgroundImage -->
            </div>
            <div class="select_dialog_option_label">
                <span class="js-option_label">Картинка и текст</span>
            </div>
        </div>
    </script>

    <!-- шаблон элемента для аплоада файла который вставляются в диалг выбора -->
    <script id="id-fileChooser_option_template" type="text/template">
        <div class="select_dialog_option js-option">
            <div class="select_dialog_option_thumb_cnt __upload">
            </div>
            <div class="select_dialog_option_label">
                <span class="js-option_label"></span>
            </div>
            <div class="file_input_wr">
                <input class="file_input" type="file" accept="image/*"/>
            </div>
        </div>
    </script>

    <!-- Элемент для добавления в диалог проекта -->
    <script id="id-select_dialog_myproject_template" type="text/template">
        <div class="select_dialog_option js-option" style="display:block">
            <div class="select_dialog_option_label">
                <span class="js-option_label">имя проекта</span>
            </div>
        </div>
    </script>

    <!-- Подсказка, может указывать на различные элементы в редакторе или внутри промо проекта -->
    <script id="id-hint_template" type="text/template">
        <div class="hint">
            <span class="js-text"></span>
        </div>
    </script>

    <!-- Шаблон для диалога публикации -->
    <script id="id-publish_dialog_template" type="text/template">
    <div class="pd_wr">
        <div class="pd">
            <div class="pd_top">
                <p class="pd_header">Ваш тест готов!</p>
                <div class="pd_tab_switcher js-tab_btns">
                    <div class="pd_tab_btn js-tab_btn __selected" data-tab-id="1">
                        <div><span class="pd_icon_link"></span></div>
                        <div>Ссылка на проект</div>
                    </div>
                    <div class="pd_tab_btn js-tab_btn" data-tab-id="2">
                        <div><span class="pd_icon_embed"></span></div>
                        <div>Код для вставки на сайт или блог</div>
                    </div>
                </div>
            </div>
            <div class="pd_tab_cnt js-tabs">
                <div class="pd_tab js-tab" data-tab-id="1">
                    <br><br>
                    <div>
                        <input class="pd_link_input js-project_link" readonly="readonly" value="http://example.com"/>
                        <span class="pbtn __green js-copy_link">Копировать</span>
                        <a href="#" target="_blank" class="pbtn js-view">Посмотреть</a>
                    </div>
                    <div class="pd_annotation_wr">
                        <p class="pd_ann">Поделитесь вашим тестом в социальный сетях</p>
                        <div class="pd_social_wr">
                            <a href="#" class="social_btn __ok"></a>
                            <a href="#" class="social_btn __vk ml12"></a>
                            <a href="#" class="social_btn __fb ml12"></a>
                            <a href="#" class="social_btn __twitter ml12"></a>
                        </div>
                    </div>
                </div>
                <div class="pd_tab js-tab" data-tab-id="2">
                    <br><br>
                    <div class="pd_col">
                        <textarea class="pd_embed_area js-embed_code" readonly="readonly"></textarea>
                    </div>
                    <div class="pd_col __w150">
                        <span class="pbtn __green js-copy_embed_code">Копировать</span>
                        <div class="pd_annotation_wr __b0">
                            <span class="tx">Не получается?</span>
                            <a href="#" class="link">Свяжитесь с нами</a>
                        </div>
                    </div>
                    <div class="pd_annotation_wr">
                        <!--<div class="pd_social_wr">-->
                        <!--<a href="#" class="social_btn __q"></a>-->
                        <!--</div>-->
                        <p class="pd_ann">Как вставить тест на сайт или в блог</p>
                    </div>
                </div>
            </div>
            <div class="close_dialog_btn js-close"></div>
        </div>
    </div>
    </script>

    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1.12.min.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/html2canvas.js"></script>
    <script type="text/javascript" src="js/rasterizeHTML.allinone.js"></script>
    <script type="text/javascript" src="js/jpeg_encoder.js"></script>
    <script type="text/javascript" src="lib/bootsrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="lib/bootsrap/js/ace.min.js"></script>
    <script type="text/javascript" src="lib/bootsrap/js/ace-elements.min.js"></script>
    <script type="text/javascript" src="lib/bootsrap/js/bootstrap-colorpicker.min.js"></script>
    <script type="text/javascript" src="js/angular.min.js"></script>
    <script type="text/javascript" src="js/model/app.js"></script>
    <script type="text/javascript" src="js/model/templates/template.js"></script>
    <script type="text/javascript" src="js/model/templates/templateCollection.js"></script>
    <script type="text/javascript" src="js/config.js"></script>
    <script type="text/javascript" src="js/util/utils.js"></script>
    <script type="text/javascript" src="js/engine.js"></script>
    <script type="text/javascript" src="js/setting.js"></script>
    <script type="text/javascript" src="js/appProperty.js"></script>
    <script type="text/javascript" src="js/appTrigger.js"></script>
    <script type="text/javascript" src="js/appPropertyPrototype.js"></script>
    <script type="text/javascript" src="js/util/queue.js"></script>
    <script type="text/javascript" src="js/util/previewService.js"></script>
    <script type="text/javascript" src="js/selectDialog.js"></script>
    <script type="text/javascript" src="js/selectUserTemplateDialog.js"></script>
    <script type="text/javascript" src="js/publishDialog.js"></script>
    <script type="text/javascript" src="js/resourceManager.js"></script>
    <script type="text/javascript" src="js/publisher.js"></script>
    <!-- Все скрипты будут объединены при сборке проекта, так что забить что их много -->
    <script type="text/javascript" src="controls/AbstractControl.js"></script>
    <script type="text/javascript" src="controls/TextQuickInput.js"></script>
    <script type="text/javascript" src="controls/Slide.js"></script>
    <script type="text/javascript" src="controls/AddArrayElementControl.js"></script>
    <script type="text/javascript" src="controls/DeleteQuickButton.js"></script>
    <script type="text/javascript" src="controls/OnOff.js"></script>
    <script type="text/javascript" src="controls/StringControl.js"></script>
    <script type="text/javascript" src="controls/Drag.js"></script>
    <script type="text/javascript" src="controls/Alternative.js"></script>
    <script type="text/javascript" src="controls/SlideGroupControl.js"></script>
    <script type="text/javascript" src="controls/ChooseImageQuick.js"></script>
    <script type="text/javascript" src="triggers/ClickTrigger.js"></script>
    <script type="text/javascript" src="triggers/SetClassTrigger.js"></script>
    <script type="text/javascript" src="js/view/modals/abstractModal.js"></script>
    <script type="text/javascript" src="js/view/modals/loadingModal.js"></script>
    <script type="text/javascript" src="js/view/modals/loginModal.js"></script>
    <script type="text/javascript" src="js/view/modals/messageModal.js"></script>
    <script type="text/javascript" src="js/view/modals/modal.js"></script>
    <script type="text/javascript" src="js/editor.js"></script>
    <script>
        $(document).ready(function() {
            if (config.common.facebookAuthEnable === true) {
                App.on(FB_CONNECTED, function(result) {
                    //TODO просто стартуем, окно логина не переведено на модал и автоматически скрывается
                    if (result === 'connected') {
                        Modal.hideLogin();
                        start();
                    }
                    else {
                        // canClose:false - леер нельзя закрыть
                        Modal.showLogin({text:'Войдите для создания своего проекта',canClose:false});
                    }
                });
                App.start();
            }
            else {
                App.start();
                start();
            }
        })
    </script><!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function (d, w, c) {
            (w[c] = w[c] || []).push(function() {
                try {
                    w.yaCounter37720792 = new Ya.Metrika({
                        id:37720792,
                        clickmap:true,
                        trackLinks:true,
                        accurateTrackBounce:true
                    });
                } catch(e) { }
            });

            var n = d.getElementsByTagName("script")[0],
                    s = d.createElement("script"),
                    f = function () { n.parentNode.insertBefore(s, n); };
            s.type = "text/javascript";
            s.async = true;
            s.src = "https://mc.yandex.ru/metrika/watch.js";

            if (w.opera == "[object Opera]") {
                d.addEventListener("DOMContentLoaded", f, false);
            } else { f(); }
        })(document, window, "yandex_metrika_callbacks");
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/37720792" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->

    <canvas id="id-preview_canvas" width="600" height="400"></canvas>
</body>
</html>